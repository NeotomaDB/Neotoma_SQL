WITH delvalues AS (
    SELECT ARRAY[30246,30247,30248,30249,30250,30251,30252,30253,30254,30255,30256,30257,30258,30259,30260,30261,30262,30263,30264,30265,30266,30267,30268,30269,30270,30271,30272,30273,30274,30275,30276,30277,30278,30279,30280,30281,30282,30283,30284,30285,30286,30287,30288,30289,30290,30291,30292,30293,30294,30295,30296,30297,30298,30299,30300,30301,30302,30303,30304,30305,30306,30307,30325,30308,30309,30310,30311,30312,30313,30314,30315,30316,30317,30318,30319,30320,30321,30322,30323,30324,30325] AS delvalue
),
anu AS (
    SELECT chroncontrolid FROM
    ndb.sites AS st
    INNER JOIN ndb.collectionunits AS cu ON cu.siteid = st.siteid
    INNER JOIN ndb.analysisunits AS au ON au.collectionunitid = cu.collectionunitid
    INNER JOIN ndb.chroncontrols AS ch ON ch.analysisunitid = au.analysisunitid
    WHERE st.siteid = ANY(ARRAY((SELECT delvalue FROM delvalues)))
)
DELETE FROM ndb.chroncontrols
WHERE chroncontrolid = ANY(SELECT chroncontrolid FROM anu);

WITH delvalues AS (
    SELECT ARRAY[30246,30247,30248,30249,30250,30251,30252,30253,30254,30255,30256,30257,30258,30259,30260,30261,30262,30263,30264,30265,30266,30267,30268,30269,30270,30271,30272,30273,30274,30275,30276,30277,30278,30279,30280,30281,30282,30283,30284,30285,30286,30287,30288,30289,30290,30291,30292,30293,30294,30295,30296,30297,30298,30299,30300,30301,30302,30303,30304,30305,30306,30307,30325,30308,30309,30310,30311,30312,30313,30314,30315,30316,30317,30318,30319,30320,30321,30322,30323,30324,30325] AS delvalue
), anu AS (
    SELECT sampleid FROM
    ndb.sites AS st
    INNER JOIN ndb.collectionunits AS cu ON cu.siteid = st.siteid
    INNER JOIN ndb.analysisunits AS au ON au.collectionunitid = cu.collectionunitid
    INNER JOIN ndb.samples AS ch ON ch.analysisunitid = au.analysisunitid
    WHERE st.siteid = ANY(ARRAY((SELECT delvalue FROM delvalues)))
)
DELETE FROM ndb.samples
WHERE sampleid = ANY(SELECT sampleid FROM anu);

WITH delvalues AS (
    SELECT ARRAY[30246,30247,30248,30249,30250,30251,30252,30253,30254,30255,30256,30257,30258,30259,30260,30261,30262,30263,30264,30265,30266,30267,30268,30269,30270,30271,30272,30273,30274,30275,30276,30277,30278,30279,30280,30281,30282,30283,30284,30285,30286,30287,30288,30289,30290,30291,30292,30293,30294,30295,30296,30297,30298,30299,30300,30301,30302,30303,30304,30305,30306,30307,30325,30308,30309,30310,30311,30312,30313,30314,30315,30316,30317,30318,30319,30320,30321,30322,30323,30324,30325] AS delvalue
)
DELETE FROM ndb.sites WHERE siteid = ANY(ARRAY((SELECT delvalue FROM delvalues)));
